@model FriendShipRequestHomeIndex
@{
    ViewData["Title"] = "Solicitudes de amistad";
    Layout = "_Layout";
}
<div class="container-fluid gedf-wrapper">
    <div class="row">
        <!-- Panel lateral izquierdo -->
        <div class="col-md-3">
            <div class="card shadow-sm border-0">
                <nav class="list-group list-group-flush">
                    <a asp-controller="" asp-action=""
                       class="list-group-item list-group-item-action text-dark fw-semibold no-link-style">
                        LinkUp (Home)
                    </a>
                    <a asp-controller="" asp-action=""
                       class="list-group-item list-group-item-action text-dark fw-semibold no-link-style">
                        Amigos
                    </a>
                    <a asp-controller="FriendShipRequest" asp-action="Index"
                       class="list-group-item list-group-item-action text-dark fw-semibold no-link-style">
                        Solicitudes de amistad
                    </a>
                    <a asp-controller="Battleship" asp-action="Index"
                       class="list-group-item list-group-item-action text-dark fw-semibold no-link-style">
                        Battleship
                    </a>
                    <div class="list-group-item bg-light">
                        <div class="h6 text-muted mb-1">Following</div>
                        <div class="h5 mb-0 fw-bold">6758</div>
                    </div>
                </nav>
            </div>
        </div>


        <div class="col-md-6 gedf-main">
            <div class="row">
                @{
                    if (ViewBag.Message != null)
                    {
                        @if (ViewBag.Message is string)
                        {
                            <div class="alert alert-info alert-dismissible fade show" role="alert">
                                <p class="text-center">@Html.Raw(ViewBag.Message.Replace("\n", "<br />"))</p>
                                <br/>
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        }
                        else
                        {
                            <div class="alert alert-info alert-dismissible fade show" role="alert">
                                @foreach (var line in ViewBag.Message)
                                {
                                    <p class="text-center">@line</p>
                                }
                                <br/>
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        }
                    }
                }

                <div class="row mt-4">
                    <table class="table table-sm table-light table-striped">
                        <thead class="table-primary">
                        <tr>
                            <th>Usuario solicitante</th>
                            <th>Cant. de amigos comunes </th>
                            <th>Fecha de solicitud</th>
                            <th>Acciones</th>
                        </tr>
                        </thead>
                        <tbody>
                        @foreach (var item in Model.FriendShipRequests)
                        {
                            <tr>
                                <td>@($"{item.RequestedByUser!.UserName}")</td>
                                <td>@item.CommonFriendsCount</td>
                                <td>@item.CreatedAt.ToShortDateString()</td>
                                <td>
                                    <a class="btn btn-sm btn-outline-warning me-2" asp-controller="FriendShipRequest"
                                       asp-action="RespondRequest"
                                       asp-route-FriendShipRequestId="@item.Id"
                                       asp-route-accepted="true"
                                       asp-route-UserName="@item.RequestedByUser.UserName">
                                        Aceptar
                                    </a>

                                    <a class="btn btn-sm btn-outline-danger" asp-controller="FriendShipRequest"
                                       asp-action="RespondRequest"
                                       asp-route-FriendShipRequestId="@item.Id"
                                       asp-route-accepted="false"
                                       asp-route-UserName="@item.RequestedByUser.UserName">
                                        Rechazar
                                    </a>

                                </td>
                            </tr>
                        }
                        </tbody>
                    </table>
                </div>

                <a class="btn btn-success" asp-controller="FriendShipRequest" asp-action="Create">Crear una nueva solicitud</a>
                <div class="row mt-4">
                    <table class="table table-sm table-light table-striped">
                        <thead class="table-primary">
                        <tr>
                            <th>Usuario destino</th>
                            <th>Fecha de solicitud</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                        </thead>
                        <tbody>
                        @foreach (var item in Model.FriendShipTargets)
                        {
                            <tr>
                                <td>@($"{item.TargetUser!.UserName}")</td>
                                <td>@item.CreatedAt.ToShortDateString()</td>
                                <td>@item.StatusText</td>
                                <td>

                                    <a class="btn btn-sm btn-outline-danger" asp-controller="FriendShipRequest"
                                       asp-action="Delete"
                                       asp-route-id="@item.Id"
                                       asp-route-UserName="@item.TargetUser!.UserName">
                                        Eliminar
                                    </a>
                                </td>
                            </tr>
                        }
                        </tbody>
                    </table>
                </div>

            </div>
        </div>

        <!-- Lateral derecho (opcional) -->
        <div class="col-md-3">
            <div class="card gedf-card mb-3">
                <div class="card-body">
                    <h5 class="card-title">Card title</h5>
                    <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6>
                    <p class="card-text">Some quick example text...</p>
                    <a href="#" class="card-link">Card link</a>
                    <a href="#" class="card-link">Another link</a>
                </div>
            </div>
        </div>
    </div>
</div>